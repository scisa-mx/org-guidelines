# Protección y roles en repositorios

# Protección y roles en repositorios

La protección del repositorio no es desconfianza, es diseño del sistema.  
Un repositorio bien protegido reduce errores humanos, evita bypass de procesos y refuerza la calidad del software sin depender de héroes técnicos.

---

## 1. Principio base: no todos los roles hacen lo mismo

En un equipo sano:
- No todos tienen los mismos permisos
- No todos aprueban
- No todos liberan

Esto no frena la colaboración, la ordena.

Principio clave:
> La responsabilidad debe estar alineada con el impacto del cambio.

---

## 2. Roles comunes en un repositorio

### 2.1 Reader / Viewer

**Responsabilidad**
- Leer código
- Revisar historial
- Entender cambios

**Permisos**
- No puede hacer push
- No puede aprobar Pull Requests
- No puede crear releases

Uso típico:
- Nuevos integrantes
- Auditoría
- Stakeholders técnicos

---

### 2.2 Contributor / Developer

**Responsabilidad**
- Desarrollar features
- Corregir bugs
- Abrir Pull Requests

**Permisos**
- Push a ramas propias o feature branches
- Crear Pull Requests
- No puede hacer merge a ramas protegidas
- No puede crear releases

Regla importante:
> El developer propone, el equipo valida.

---

### 2.3 Reviewer / Approver

**Responsabilidad**
- Revisar código
- Validar estándares
- Aprobar Pull Requests

**Permisos**
- Aprobar Pull Requests
- No puede hacer push directo a ramas protegidas
- No puede saltarse pipelines

Normalmente:
- Seniors
- Tech Leads
- Developers con ownership de módulos

---

### 2.4 Maintainer / Lead

**Responsabilidad**
- Mantener la salud del repositorio
- Resolver conflictos
- Asegurar cumplimiento de reglas

**Permisos**
- Hacer merge a ramas protegidas
- Administrar reglas de Pull Requests
- Revertir cambios

Este rol no es operativo diario, es de control y soporte.

---

### 2.5 Admin

**Responsabilidad**
- Configuración del repositorio
- Seguridad
- Integraciones

**Permisos**
- Acceso total

Regla organizacional:
> El rol Admin debe ser mínimo y excepcional.

---

## 3. Protección de ramas

### 3.1 Ramas que deben estar protegidas

Generalmente:
- main
- master
- release/*
- develop (según el flujo)

---

### 3.2 Reglas mínimas recomendadas

Para ramas protegidas:
- No se permite push directo
- Pull Request obligatorio
- Al menos una o dos aprobaciones
- Pipeline exitoso obligatorio
- No se permite bypass de reglas, salvo emergencias controladas

---

## 4. Pull Requests y roles

Un Pull Request saludable implica:
- El autor no puede auto-aprobar
- El reviewer no es el autor
- El merge lo realiza quien tenga permiso, no cualquier contributor

Esto refuerza:
- Separación de responsabilidades
- Revisión real, no simbólica

---

## 5. Protección de releases y tags

Buenas prácticas:
- Solo Maintainers o Leads pueden crear tags
- Solo Maintainers o Leads pueden disparar releases
- Los tags deben generarse desde ramas protegidas
- El pipeline debe ejecutarse correctamente antes del release

Regla clara:
> Si cualquiera puede crear un release, nadie es responsable del release.

---

## 6. Integración con CI/CD

La protección del repositorio debe apoyarse en pipelines, no reemplazarlos.

Ejemplos:
- Un Pull Request no puede mergearse si el pipeline falla
- Un release no se crea si no hay versión válida
- El deploy requiere aprobación por rol

Esto convierte al repositorio en un sistema confiable, no solo un almacén de código.

---

## 7. Casos especiales y excepciones

### Emergencias y hotfix críticos

- Deben existir
- Deben estar documentados
- Deben dejar rastro

Ejemplos:
- Acceso temporal
- Pull Request posterior explicando el bypass
- Registro en changelog

Emergencia no equivale a permiso permanente.

---

## 8. Errores comunes a evitar

- Todos son admins
- Push directo a main
- Auto-aprobaciones
- Pipelines opcionales
- Reglas solo de palabra

Si depende de la memoria del equipo, ya es un riesgo.

---

## Idea central

La protección y los roles en repositorios no ralentizan ni burocratizan el desarrollo, lo escalan.

Un repositorio bien protegido permite:
- Crecer sin caos
- Rotar personas sin romper procesos
- Confiar en que lo que llega a producción pasó por el camino correcto
