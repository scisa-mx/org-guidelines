# Validación previa y posterior al deploy

Un deploy no es un evento técnico aislado, es un **momento crítico del ciclo de vida del software**.  
La validación antes y después del deploy reduce riesgos, evita regresiones y permite reaccionar rápidamente ante fallos.

Estas reglas definen las validaciones mínimas que deben realizarse **antes** y **después** de cualquier despliegue.

---

## 1. Principio base

Un deploy exitoso no es solo que el pipeline termine en verde.  
Un deploy exitoso es aquel donde el sistema **sigue funcionando correctamente en su entorno destino**.

Principio clave:
> Si no se valida, no se puede confiar.

---

## 2. Validación previa al deploy

La validación previa busca asegurar que **lo que se va a desplegar es estable, correcto y esperado**.

---

### 2.1 Estado del código

Antes del deploy se debe validar:
- El código proviene de una rama protegida
- El commit está versionado y etiquetado
- No existen cambios pendientes o no revisados

Checklist mínima:
- Pull Request aprobado
- Reglas de protección cumplidas
- Tag de versión presente

---

### 2.2 Pipeline y artefactos

El pipeline debe:
- Compilar sin errores
- Ejecutar todas las pruebas automáticas
- Generar artefactos reproducibles

Reglas:
- No se permite deploy manual desde local
- El artefacto a desplegar debe ser el generado por el pipeline
- No se permiten builds ad-hoc para producción

---

### 2.3 Configuración y entorno

Antes del deploy se debe confirmar:
- Variables de entorno correctas
- Secrets configurados
- Conexiones externas válidas

Ejemplos:
- Cadenas de conexión
- Endpoints de servicios
- Feature flags

Principio:
> El código puede estar bien, pero el entorno puede romperlo.

---

### 2.4 Compatibilidad y migraciones

Si el deploy incluye:
- Migraciones de base de datos
- Cambios de esquema
- Cambios de contratos

Debe validarse:
- Compatibilidad hacia atrás
- Estrategia de rollback
- Orden correcto de ejecución

---

## 3. Validación posterior al deploy

La validación posterior busca confirmar que **el sistema está operando correctamente en el entorno real**.

---

### 3.1 Smoke tests

Después del deploy se deben ejecutar validaciones rápidas:
- Servicios levantan correctamente
- Endpoints críticos responden
- Aplicación inicia sin errores

Ejemplos:
- Health checks
- Ping a endpoints principales
- Verificación de logs iniciales

---

### 3.2 Validación funcional mínima

Se deben validar flujos críticos:
- Login
- Operación principal del negocio
- Acciones básicas del sistema

Estas validaciones pueden ser:
- Automáticas
- Manuales guiadas
- E2E básicas

---

### 3.3 Monitoreo y observabilidad

Después del deploy se debe observar:
- Logs
- Métricas
- Alertas

Indicadores clave:
- Errores inesperados
- Incremento de latencia
- Fallos en dependencias externas

Regla:
> El deploy no termina cuando se publica, termina cuando se observa estable.

---

### 3.4 Validación de datos

Si el sistema maneja datos críticos:
- Verificar integridad
- Verificar consistencia
- Verificar que no hubo pérdida o corrupción

Ejemplos:
- Registros creados correctamente
- Estados esperados
- Datos históricos intactos

---

## 4. Rollback y contingencia

Todo deploy debe:
- Tener estrategia de rollback definida
- Poder revertirse rápidamente
- Dejar registro del evento

Rollback no es fracaso, es control de daños.

---

## 5. Responsabilidades

Antes del deploy:
- Equipo valida código y pipeline

Después del deploy:
- Equipo valida comportamiento
- Leads o responsables confirman estabilidad

Las responsabilidades deben estar claras antes del despliegue.

---

## 6. Errores comunes a evitar

- Confiar solo en el pipeline
- No validar entorno
- No monitorear después del deploy
- No tener plan de rollback
- Asumir que “si compiló, funciona”

---

## Idea central

La validación previa y posterior al deploy transforma el despliegue de un ri
