# 2.6 Pol√≠ticas sobre _code smells_ y _refactoring_

- Durante el desarrollo, el objetivo principal es entregar funcionalidad correcta y alineada al requerimiento. Sin embargo, antes de subir cualquier cambio, se espera que cada desarrollador haga una revisi√≥n consciente de la calidad del c√≥digo producido.

Esto implica:

Revisar el c√≥digo m√°s all√° de que ‚Äúfuncione‚Äù.

Detectar se√±ales de dise√±o que puedan indicar problemas a corto o mediano plazo.

Aplicar refactoring cuando sea necesario para mejorar:

- Legibilidad

‚ùå Antes
```
if (u != null && u.A && u.B && u.C)
{
    DoStuff();
}
```

‚úÖ Despu√©s
```
if (IsValidUser(user))
{
    ProcessUser();
}

bool IsValidUser(User user)
{
    return user != null
        && user.IsActive
        && user.HasAcceptedTerms
        && user.HasProfileCompleted;
}
```
- Simplicidad

‚ùå Antes
```
var result = false;

if (order != null)
{
    if (order.Items != null)
    {
        if (order.Items.Count > 0)
        {
            result = true;
        }
    }
}

```

‚úÖ Despu√©s
```
var hasItems = order?.Items?.Any() == true;
```

- Mantenibilidad

‚ùå Antes
```
if (type == 1)
{
    ApplyDiscount(0.10m);
}
else if (type == 2)
{
    ApplyDiscount(0.15m);
}
else if (type == 3)
{
    ApplyDiscount(0.20m);
}

```

‚úÖ Despu√©s
```
var discount = type switch
{
    CustomerType.Regular => 0.10m,
    CustomerType.Premium => 0.15m,
    CustomerType.Vip     => 0.20m,
    _ => 0m
};

ApplyDiscount(discount);
```

- Claridad de intenci√≥n

‚ùå Antes
```
foreach (var u in users)
{
    if (u.LastLogin < DateTime.UtcNow.AddDays(-30))
    {
        u.IsActive = false;
    }
}
```

‚úÖ Despu√©s
```
DeactivateInactiveUsers(users);

void DeactivateInactiveUsers(IEnumerable<User> users)
{
    foreach (var user in users)
    {
        if (IsInactive(user))
        {
            user.IsActive = false;
        }
    }
}

bool IsInactive(User user)
{
    return user.LastLogin < DateTime.UtcNow.AddDays(-30);
}
```

El refactoring no es una fase separada ni opcional, sino una parte natural del cierre del trabajo. No se espera perfecci√≥n, pero s√≠ criterio profesional para no introducir deuda t√©cnica evitable.

Como referencia conceptual y pr√°ctica sobre code smells y t√©cnicas de refactoring, se recomienda consultar el siguiente recurso, el cual es amplio y completo:

üîó https://refactoring.guru/

Este material sirve como gu√≠a para identificar problemas comunes y entender cu√°ndo un refactor es apropiado, pero el criterio final siempre debe alinearse a las necesidades reales del proyecto.
